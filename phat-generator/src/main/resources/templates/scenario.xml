@@@program xmlns:xsi="http://www.w3.org/2000/10/XMLSchema-instance"@@@

	@@@saveto@@@
		@@@file overwrite="yes"@@@
			@@@v@@@output@@@/v@@@/phat/ucm/MainScenario.java@@@/file@@@
@@@text@@@
package phat.ucm;

import com.aurellem.capture.Capture;
import com.jme3.math.ColorRGBA;
import com.jme3.scene.Node;
import com.jme3.system.AppSettings;
import com.jme3.system.JmeContext;

import java.io.File;
import java.io.IOException;
import java.util.logging.Level;
import java.util.logging.Logger;

import phat.audio.PHATApplication;
import phat.mason.MASONAppState;
import phat.mason.PHATSimState;
import phat.mason.agents.*;
import phat.mason.space.Util;
import phat.mason.utils.AlarmFrame;
import sim.engine.SimState;
import sim.field.continuous.Continuous3D;
import sim.util.Double3D;

public class MainScenario extends PHATSimState {
    private String houseID;
    private boolean visualization = true;
    private boolean initialized = false;
    
    private Continuous3D world;
    private MASONAppState masonAppState;
    private PHATApplication app;
    
    public static void main(String[] args) {
    	MainScenario sim = new MainScenario(System.currentTimeMillis());
        sim.setHouseID("Scenes/Structures/Houses/House3room2bath/House3room2bath.j3o");
        sim.setVisualization(true);
        
        sim.start();        
    }
    
    public MainScenario(long seed) {
        super(seed);        
    }
    
    public void init(MASONAppState masonAppState) {
        
        masonAppState.getTimeAdapter().setTimePerStep(1f);
        
        Continuous3D world = getWorld();
        
        masonAppState.getHouseAdapter().getHouse().createPointLight("Kitchen", ColorRGBA.White, 5f);
        masonAppState.getHouseAdapter().getHouse().createPointLight("BathRoom1", ColorRGBA.White, 0.1f);
        masonAppState.getHouseAdapter().getHouse().createPointLight("BedRoom1", ColorRGBA.White, 5f);
        
       @@@repeat id="actors"@@@
            {
            int roomNum = masonAppState.getHouseAdapter().getHouse().getRoomNames().size();
            String randomRoomName = masonAppState.getHouseAdapter().getHouse().getRoomNames().get(random.nextInt(roomNum));
            Double3D loc = Util.get(masonAppState.getHouseAdapter().getHouse().getCoordenates(randomRoomName)); 
            PhysicsActor pa = masonAppState.getActorAdapter().createRelative("@@@v@@@actorname@@@/v@@@", loc);
            pa.showName(true);
            @@@v@@@actorname@@@/v@@@Agent agent = new @@@v@@@actorname@@@/v@@@Agent(pa, this);
                           @@@repeat id="actors"@@@
                           @@@/repeat@@@ 
            schedule.scheduleRepeating(agent);
            }            
       @@@/repeat@@@   
        
        setInitialized(true);
    }
}


@@@/text@@@
	@@@/saveto@@@
	
@@@/program@@@